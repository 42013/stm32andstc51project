C51 COMPILER V9.54   TURN                                                                  04/08/2023 11:31:00 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TURN
OBJECT MODULE PLACED IN .\Objects\turn.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE turn.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\turn.l
                    -st) TABS(2) OBJECT(.\Objects\turn.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          sbit PWM = P2^0;  //设定PWM输出的I/O端口
   4          unsigned char count = 0;
   5          unsigned char timer1 ;
   6          /*
   7          对于180°舵机
   8          t = 0.5ms——————-舵机会转动 0 ° 
   9          t = 1.0ms——————-舵机会转动 45°
  10          t = 1.5ms——————-舵机会转动 90°
  11          t = 2.0ms——————-舵机会转动 135°
  12          t = 2.5ms——————-舵机会转动180
  13          */
  14          
  15           
  16           
  17          /*延时程序*/
  18          void delay1s(void)   //误差 0us
  19          {
  20   1          unsigned char a,b,c;
  21   1          for(c=167;c>0;c--)
  22   1              for(b=171;b>0;b--)
  23   1                  for(a=16;a>0;a--);
  24   1          _nop_();  //if Keil,require use intrins.h
  25   1      }
  26           
  27          /*定时器T0初始化*/
  28          void Timer0_Init()           
  29          {
  30   1          TMOD &= 0x00;
  31   1          TMOD |= 0x01; //定时器T0设置成方式1
  32   1       
  33   1          //TL0 = 0x50;   //设置定时初值
  34   1      //  TH0 = 0xFB;   //设置定时初值
  35   1        TH0 = 0xff;   //定时常数 0.1ms 晶振为11.0592MHz
  36   1          TL0 = 0xa4;
  37   1          ET0 = 1;      
  38   1          TR0 = 1; 
  39   1        EA=1; 
  40   1        }
  41            
  42          /*T0中断初始化*/
  43          void Time0_Init() interrupt 1 
  44          {
  45   1        TR0 = 0; 
  46   1        //TL0 = 0x50;   //设置定时初值
  47   1        //TH0 = 0xFB;   //设置定时初值
  48   1         TH0 = 0xff;   //定时常数 0.1ms 晶振为11.0592MHz
  49   1          TL0 = 0xa4;
  50   1        if(count <= timer1) //5==0° 15==90°
  51   1        { 
  52   2          PWM = 1; 
  53   2        }
  54   1        else 
C51 COMPILER V9.54   TURN                                                                  04/08/2023 11:31:00 PAGE 2   

  55   1        { 
  56   2          PWM = 0; 
  57   2        }
  58   1        count++;
  59   1        if (count >= 200) //T = 20ms清零
  60   1        { 
  61   2          count = 0; 
  62   2        }
  63   1        TR0 = 1; //开启T0
  64   1      }
  65          void main()
  66          {
  67   1        Timer0_Init();
  68   1        while(1)
  69   1        {
  70   2          timer1 =5;//舵机恢复到0°的位置
  71   2          count=0;//让定时器重新计数
  72   2          delay1s();
  73   2          timer1 =8;//舵机旋转
  74   2          count=0;
  75   2          delay1s();
  76   2        }
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     99    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)

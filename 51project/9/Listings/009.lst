C51 COMPILER V9.54   009                                                                   03/29/2023 18:17:34 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 009
OBJECT MODULE PLACED IN .\Objects\009.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE 009.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\009.lst
                    -) TABS(2) OBJECT(.\Objects\009.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <intrins.h>
   3          typedef unsigned int uint  ;
   4          typedef unsigned char uchar ;
   5          sbit BEEP = P2^5;
   6          sbit Trig=P2^1;
   7          sbit Echo=P2^0; 
   8          sbit k1=P3^1;
   9          sbit k2=P3^0;
  10          sbit k3=P3^2;
  11          unsigned int number1,number2,number3,c;
  12          float time,distance;
  13          void Time0Init()
  14          {
  15   1        TMOD |= 0x01;   
  16   1        TL0 = 0x00;   
  17   1        TH0 = 0x00; 
  18   1        TR0 = 0;  
  19   1      }
  20          
  21          //0x06|0x80
  22          void ultrasonicwave_init(void)
  23          {
  24   1        Trig=0;
  25   1        Echo=1;
  26   1        Time0Init();
  27   1      } 
  28          int dot = 5;
  29          void mioo() interrupt 0
  30          {
  31   1        dot--;
  32   1        if(dot )
  33   1          dot = 6;
  34   1        while(!P3_2);
  35   1      }
  36          void delay(unsigned int xms)    //@12.000MHz
  37          { 
  38   1        unsigned char i;
  39   1        while(xms--)
  40   1        {
  41   2        _nop_();
  42   2        i = 2;
  43   2        while (--i);
  44   2        }
  45   1      }
  46          
  47          void startHC()
  48          {
  49   1          Trig=1; 
  50   1          delay(2);
  51   1          Trig=0;  
  52   1      }
  53          void Buzzer_Delay()  //@12.000MHz
  54          {
C51 COMPILER V9.54   009                                                                   03/29/2023 18:17:34 PAGE 2   

  55   1       unsigned char i;
  56   1        _nop_  ();
  57   1       i = 80;
  58   1       while (--i);
  59   1      }
  60          void zong()
  61          {
  62   1           Time0Init();
  63   1           startHC();
  64   1        while(Echo == 0);
  65   1              TR0 = 1;
  66   1           while(Echo == 1);
  67   1              TR0 = 0;
  68   1          time = (TH0 * 256 + TL0)*1.085;
  69   1          distance = time * 0.017;
  70   1        distance=distance*10;
  71   1        c=(int)distance;
  72   1          number1=c/1000%10;
  73   1          number2=c/100%10;
  74   1          number3=c/10%10;
  75   1        if(distance<=1000){
  76   2          uint ms=1000,i;
  77   2          for(i=0;i<ms*0.1;i++)
  78   2         {
  79   3         BEEP=!BEEP;
  80   3         Buzzer_Delay();
  81   3         }
  82   2       }else{
  83   2             BEEP=1;
  84   2             delay(50);
  85   2             BEEP=0;
  86   2             delay(50);
  87   2        }
  88   1       }
  89          unsigned char Nixietable[10]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F};
  90          
  91          void Nixie(unsigned char location,unsigned char number){
  92   1        switch(location){
  93   2          case 1:P2_4=1;P2_3=1;P2_2=1; break;
  94   2          case 2:P2_4=1;P2_3=1;P2_2=0; break;
  95   2          case 3:P2_4=1;P2_3=0;P2_2=1; break;
  96   2          case 4:P2_4=1;P2_3=0;P2_2=0; break;
  97   2          case 5:P2_4=0;P2_3=1;P2_2=1; break;
  98   2          case 6:P2_4=0;P2_3=1;P2_2=0; break;
  99   2          case 7:P2_4=0;P2_3=0;P2_2=1; break;
 100   2          case 8:P2_4=0;P2_3=0;P2_2=0; break;
 101   2        }
 102   1        P0=Nixietable[number];
 103   1        delay(800);
 104   1        P0=0x00;
 105   1      }
 106          
 107          
 108          void main(){
 109   1          ultrasonicwave_init();//启动并计时
 110   1      while(1)
 111   1           {
 112   2           zong();
 113   2            Nixie(8, 0);
 114   2           delay(10);
 115   2           Nixie(7, number1);
 116   2           delay(10);
C51 COMPILER V9.54   009                                                                   03/29/2023 18:17:34 PAGE 3   

 117   2           Nixie(6, number2);
 118   2           delay(10);
 119   2           Nixie(5, number3);
 120   2           delay(10);
 121   2       if(k1==0)
 122   2         {
 123   3           delay(1);
 124   3           if(k1==0)
 125   3           {
 126   4            delay(1);
 127   4            if(k1==1)
 128   4            {
 129   5              delay(1);
 130   5            }
 131   4          }
 132   3          while(!k1);//cm
 133   3          while(1)
 134   3           {
 135   4          zong();
 136   4             Nixie(8, 0);
 137   4           delay(10);
 138   4             Nixie(7, number1);
 139   4           delay(10);
 140   4          Nixie(6, number2);
 141   4          delay(10);
 142   4          Nixie(5, number3);
 143   4          delay(10);
 144   4            if(k2==0||k3==0)
 145   4               {
 146   5            delay(1);
 147   5            if(k2==0||k3==0)
 148   5            {
 149   6              delay(1);
 150   6              break;
 151   6            }
 152   5             }
 153   4          }
 154   3        }
 155   2      
 156   2       if(k2==0)
 157   2         {
 158   3          delay(1);
 159   3          if(k2==0)
 160   3          {
 161   4            if(k2==1)
 162   4            {
 163   5              delay(1);
 164   5            }
 165   4          }
 166   3             while(!k2);//DM
 167   3          while(1)
 168   3          {
 169   4            zong();
 170   4            Nixie(8,0);
 171   4           delay(10);
 172   4           Nixie(7, 0);
 173   4           delay(10);
 174   4           Nixie(6, number1);
 175   4           delay(10);
 176   4           Nixie(5, number2);
 177   4           delay(10);
 178   4            if(k1==0||k3==0)
C51 COMPILER V9.54   009                                                                   03/29/2023 18:17:34 PAGE 4   

 179   4            {
 180   5              if(k1==0||k3==0)
 181   5            {
 182   6              delay(1);
 183   6              break;
 184   6            }
 185   5            }
 186   4          }
 187   3          }
 188   2         
 189   2       if(k3==0)
 190   2         {
 191   3          delay(1);
 192   3          if(k3==0)
 193   3          {
 194   4            if(k3==1)
 195   4            {
 196   5              break;
 197   5            }
 198   4          }
 199   3          while(!k3);
 200   3          while(1)//M
 201   3          {
 202   4           zong();
 203   4           Nixie(8, 0);
 204   4           delay(10);
 205   4           Nixie(7, 0);
 206   4           delay(10);
 207   4           Nixie(6, 0);
 208   4           delay(10);
 209   4            Nixie(5, number1);
 210   4           delay(10);
 211   4            if(k1==0||k2==0)
 212   4            {
 213   5            if(k1==0||k2==0)
 214   5            {
 215   6              delay(1);
 216   6              break;
 217   6            }
 218   5            }
 219   4          }
 220   3          }
 221   2          }
 222   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    758    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     28       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
